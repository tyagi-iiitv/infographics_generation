{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Global_1 = require(\"./Global\");\n\nvar Util_1 = require(\"./Util\");\n\nexports.DD = {\n  get isDragging() {\n    var flag = false;\n\n    exports.DD._dragElements.forEach(function (elem) {\n      if (elem.dragStatus === 'dragging') {\n        flag = true;\n      }\n    });\n\n    return flag;\n  },\n\n  justDragged: false,\n\n  get node() {\n    var node;\n\n    exports.DD._dragElements.forEach(function (elem) {\n      node = elem.node;\n    });\n\n    return node;\n  },\n\n  _dragElements: new Map(),\n  _drag: function (evt) {\n    exports.DD._dragElements.forEach(function (elem, key) {\n      var node = elem.node;\n      var stage = node.getStage();\n      stage.setPointersPositions(evt);\n\n      if (elem.pointerId === undefined) {\n        elem.pointerId = Util_1.Util._getFirstPointerId(evt);\n      }\n\n      var pos = stage._changedPointerPositions.find(function (pos) {\n        return pos.id === elem.pointerId;\n      });\n\n      if (!pos) {\n        return;\n      }\n\n      if (elem.dragStatus !== 'dragging') {\n        var dragDistance = node.dragDistance();\n        var distance = Math.max(Math.abs(pos.x - elem.startPointerPos.x), Math.abs(pos.y - elem.startPointerPos.y));\n\n        if (distance < dragDistance) {\n          return;\n        }\n\n        node.startDrag({\n          evt: evt\n        });\n\n        if (!node.isDragging()) {\n          return;\n        }\n      }\n\n      node._setDragPosition(evt, elem);\n\n      node.fire('dragmove', {\n        type: 'dragmove',\n        target: node,\n        evt: evt\n      }, true);\n    });\n  },\n  _endDragBefore: function (evt) {\n    exports.DD._dragElements.forEach(function (elem, key) {\n      var node = elem.node;\n      var stage = node.getStage();\n\n      if (evt) {\n        stage.setPointersPositions(evt);\n      }\n\n      var pos = stage._changedPointerPositions.find(function (pos) {\n        return pos.id === elem.pointerId;\n      });\n\n      if (!pos) {\n        return;\n      }\n\n      if (elem.dragStatus === 'dragging' || elem.dragStatus === 'stopped') {\n        exports.DD.justDragged = true;\n        Global_1.Konva.listenClickTap = false;\n        elem.dragStatus = 'stopped';\n      }\n\n      var drawNode = elem.node.getLayer() || elem.node instanceof Global_1.Konva['Stage'] && elem.node;\n\n      if (drawNode) {\n        drawNode.draw();\n      }\n    });\n  },\n  _endDragAfter: function (evt) {\n    exports.DD._dragElements.forEach(function (elem, key) {\n      if (elem.dragStatus === 'stopped') {\n        elem.node.fire('dragend', {\n          type: 'dragend',\n          target: elem.node,\n          evt: evt\n        }, true);\n      }\n\n      if (elem.dragStatus !== 'dragging') {\n        exports.DD._dragElements.delete(key);\n      }\n    });\n  }\n};\n\nif (Global_1.Konva.isBrowser) {\n  window.addEventListener('mouseup', exports.DD._endDragBefore, true);\n  window.addEventListener('touchend', exports.DD._endDragBefore, true);\n  window.addEventListener('mousemove', exports.DD._drag);\n  window.addEventListener('touchmove', exports.DD._drag);\n  window.addEventListener('mouseup', exports.DD._endDragAfter, false);\n  window.addEventListener('touchend', exports.DD._endDragAfter, false);\n}","map":{"version":3,"sources":["/mnt/c/Users/anjul/OneDrive - Stony Brook University/Documents/infographics_generation/interface/node_modules/konva/lib/DragAndDrop.js"],"names":["Object","defineProperty","exports","value","Global_1","require","Util_1","DD","isDragging","flag","_dragElements","forEach","elem","dragStatus","justDragged","node","Map","_drag","evt","key","stage","getStage","setPointersPositions","pointerId","undefined","Util","_getFirstPointerId","pos","_changedPointerPositions","find","id","dragDistance","distance","Math","max","abs","x","startPointerPos","y","startDrag","_setDragPosition","fire","type","target","_endDragBefore","Konva","listenClickTap","drawNode","getLayer","draw","_endDragAfter","delete","isBrowser","window","addEventListener"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Global_1 = require(\"./Global\");\nvar Util_1 = require(\"./Util\");\nexports.DD = {\n    get isDragging() {\n        var flag = false;\n        exports.DD._dragElements.forEach(function (elem) {\n            if (elem.dragStatus === 'dragging') {\n                flag = true;\n            }\n        });\n        return flag;\n    },\n    justDragged: false,\n    get node() {\n        var node;\n        exports.DD._dragElements.forEach(function (elem) {\n            node = elem.node;\n        });\n        return node;\n    },\n    _dragElements: new Map(),\n    _drag: function (evt) {\n        exports.DD._dragElements.forEach(function (elem, key) {\n            var node = elem.node;\n            var stage = node.getStage();\n            stage.setPointersPositions(evt);\n            if (elem.pointerId === undefined) {\n                elem.pointerId = Util_1.Util._getFirstPointerId(evt);\n            }\n            var pos = stage._changedPointerPositions.find(function (pos) { return pos.id === elem.pointerId; });\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus !== 'dragging') {\n                var dragDistance = node.dragDistance();\n                var distance = Math.max(Math.abs(pos.x - elem.startPointerPos.x), Math.abs(pos.y - elem.startPointerPos.y));\n                if (distance < dragDistance) {\n                    return;\n                }\n                node.startDrag({ evt: evt });\n                if (!node.isDragging()) {\n                    return;\n                }\n            }\n            node._setDragPosition(evt, elem);\n            node.fire('dragmove', {\n                type: 'dragmove',\n                target: node,\n                evt: evt\n            }, true);\n        });\n    },\n    _endDragBefore: function (evt) {\n        exports.DD._dragElements.forEach(function (elem, key) {\n            var node = elem.node;\n            var stage = node.getStage();\n            if (evt) {\n                stage.setPointersPositions(evt);\n            }\n            var pos = stage._changedPointerPositions.find(function (pos) { return pos.id === elem.pointerId; });\n            if (!pos) {\n                return;\n            }\n            if (elem.dragStatus === 'dragging' || elem.dragStatus === 'stopped') {\n                exports.DD.justDragged = true;\n                Global_1.Konva.listenClickTap = false;\n                elem.dragStatus = 'stopped';\n            }\n            var drawNode = elem.node.getLayer() ||\n                (elem.node instanceof Global_1.Konva['Stage'] && elem.node);\n            if (drawNode) {\n                drawNode.draw();\n            }\n        });\n    },\n    _endDragAfter: function (evt) {\n        exports.DD._dragElements.forEach(function (elem, key) {\n            if (elem.dragStatus === 'stopped') {\n                elem.node.fire('dragend', {\n                    type: 'dragend',\n                    target: elem.node,\n                    evt: evt\n                }, true);\n            }\n            if (elem.dragStatus !== 'dragging') {\n                exports.DD._dragElements.delete(key);\n            }\n        });\n    }\n};\nif (Global_1.Konva.isBrowser) {\n    window.addEventListener('mouseup', exports.DD._endDragBefore, true);\n    window.addEventListener('touchend', exports.DD._endDragBefore, true);\n    window.addEventListener('mousemove', exports.DD._drag);\n    window.addEventListener('touchmove', exports.DD._drag);\n    window.addEventListener('mouseup', exports.DD._endDragAfter, false);\n    window.addEventListener('touchend', exports.DD._endDragAfter, false);\n}\n"]},"metadata":{},"sourceType":"script"}