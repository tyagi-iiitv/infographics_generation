{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Util_1 = require(\"../Util\");\n\nvar Factory_1 = require(\"../Factory\");\n\nvar Shape_1 = require(\"../Shape\");\n\nvar Group_1 = require(\"../Group\");\n\nvar Validators_1 = require(\"../Validators\");\n\nvar Global_1 = require(\"../Global\");\n\nvar ATTR_CHANGE_LIST = ['fontFamily', 'fontSize', 'fontStyle', 'padding', 'lineHeight', 'text', 'width'],\n    CHANGE_KONVA = 'Change.konva',\n    NONE = 'none',\n    UP = 'up',\n    RIGHT = 'right',\n    DOWN = 'down',\n    LEFT = 'left',\n    attrChangeListLen = ATTR_CHANGE_LIST.length;\n\nvar Label = function (_super) {\n  __extends(Label, _super);\n\n  function Label(config) {\n    var _this = _super.call(this, config) || this;\n\n    _this.on('add.konva', function (evt) {\n      this._addListeners(evt.child);\n\n      this._sync();\n    });\n\n    return _this;\n  }\n\n  Label.prototype.getText = function () {\n    return this.find('Text')[0];\n  };\n\n  Label.prototype.getTag = function () {\n    return this.find('Tag')[0];\n  };\n\n  Label.prototype._addListeners = function (text) {\n    var that = this,\n        n;\n\n    var func = function () {\n      that._sync();\n    };\n\n    for (n = 0; n < attrChangeListLen; n++) {\n      text.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, func);\n    }\n  };\n\n  Label.prototype.getWidth = function () {\n    return this.getText().width();\n  };\n\n  Label.prototype.getHeight = function () {\n    return this.getText().height();\n  };\n\n  Label.prototype._sync = function () {\n    var text = this.getText(),\n        tag = this.getTag(),\n        width,\n        height,\n        pointerDirection,\n        pointerWidth,\n        x,\n        y,\n        pointerHeight;\n\n    if (text && tag) {\n      width = text.width();\n      height = text.height();\n      pointerDirection = tag.pointerDirection();\n      pointerWidth = tag.pointerWidth();\n      pointerHeight = tag.pointerHeight();\n      x = 0;\n      y = 0;\n\n      switch (pointerDirection) {\n        case UP:\n          x = width / 2;\n          y = -1 * pointerHeight;\n          break;\n\n        case RIGHT:\n          x = width + pointerWidth;\n          y = height / 2;\n          break;\n\n        case DOWN:\n          x = width / 2;\n          y = height + pointerHeight;\n          break;\n\n        case LEFT:\n          x = -1 * pointerWidth;\n          y = height / 2;\n          break;\n      }\n\n      tag.setAttrs({\n        x: -1 * x,\n        y: -1 * y,\n        width: width,\n        height: height\n      });\n      text.setAttrs({\n        x: -1 * x,\n        y: -1 * y\n      });\n    }\n  };\n\n  return Label;\n}(Group_1.Group);\n\nexports.Label = Label;\nLabel.prototype.className = 'Label';\n\nGlobal_1._registerNode(Label);\n\nUtil_1.Collection.mapMethods(Label);\n\nvar Tag = function (_super) {\n  __extends(Tag, _super);\n\n  function Tag() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Tag.prototype._sceneFunc = function (context) {\n    var width = this.width(),\n        height = this.height(),\n        pointerDirection = this.pointerDirection(),\n        pointerWidth = this.pointerWidth(),\n        pointerHeight = this.pointerHeight(),\n        cornerRadius = Math.min(this.cornerRadius(), width / 2, height / 2);\n    context.beginPath();\n\n    if (!cornerRadius) {\n      context.moveTo(0, 0);\n    } else {\n      context.moveTo(cornerRadius, 0);\n    }\n\n    if (pointerDirection === UP) {\n      context.lineTo((width - pointerWidth) / 2, 0);\n      context.lineTo(width / 2, -1 * pointerHeight);\n      context.lineTo((width + pointerWidth) / 2, 0);\n    }\n\n    if (!cornerRadius) {\n      context.lineTo(width, 0);\n    } else {\n      context.lineTo(width - cornerRadius, 0);\n      context.arc(width - cornerRadius, cornerRadius, cornerRadius, Math.PI * 3 / 2, 0, false);\n    }\n\n    if (pointerDirection === RIGHT) {\n      context.lineTo(width, (height - pointerHeight) / 2);\n      context.lineTo(width + pointerWidth, height / 2);\n      context.lineTo(width, (height + pointerHeight) / 2);\n    }\n\n    if (!cornerRadius) {\n      context.lineTo(width, height);\n    } else {\n      context.lineTo(width, height - cornerRadius);\n      context.arc(width - cornerRadius, height - cornerRadius, cornerRadius, 0, Math.PI / 2, false);\n    }\n\n    if (pointerDirection === DOWN) {\n      context.lineTo((width + pointerWidth) / 2, height);\n      context.lineTo(width / 2, height + pointerHeight);\n      context.lineTo((width - pointerWidth) / 2, height);\n    }\n\n    if (!cornerRadius) {\n      context.lineTo(0, height);\n    } else {\n      context.lineTo(cornerRadius, height);\n      context.arc(cornerRadius, height - cornerRadius, cornerRadius, Math.PI / 2, Math.PI, false);\n    }\n\n    if (pointerDirection === LEFT) {\n      context.lineTo(0, (height + pointerHeight) / 2);\n      context.lineTo(-1 * pointerWidth, height / 2);\n      context.lineTo(0, (height - pointerHeight) / 2);\n    }\n\n    if (cornerRadius) {\n      context.lineTo(0, cornerRadius);\n      context.arc(cornerRadius, cornerRadius, cornerRadius, Math.PI, Math.PI * 3 / 2, false);\n    }\n\n    context.closePath();\n    context.fillStrokeShape(this);\n  };\n\n  Tag.prototype.getSelfRect = function () {\n    var x = 0,\n        y = 0,\n        pointerWidth = this.pointerWidth(),\n        pointerHeight = this.pointerHeight(),\n        direction = this.pointerDirection(),\n        width = this.width(),\n        height = this.height();\n\n    if (direction === UP) {\n      y -= pointerHeight;\n      height += pointerHeight;\n    } else if (direction === DOWN) {\n      height += pointerHeight;\n    } else if (direction === LEFT) {\n      x -= pointerWidth * 1.5;\n      width += pointerWidth;\n    } else if (direction === RIGHT) {\n      width += pointerWidth * 1.5;\n    }\n\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n\n  return Tag;\n}(Shape_1.Shape);\n\nexports.Tag = Tag;\nTag.prototype.className = 'Tag';\n\nGlobal_1._registerNode(Tag);\n\nFactory_1.Factory.addGetterSetter(Tag, 'pointerDirection', NONE);\nFactory_1.Factory.addGetterSetter(Tag, 'pointerWidth', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Tag, 'pointerHeight', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Tag, 'cornerRadius', 0, Validators_1.getNumberValidator());\nUtil_1.Collection.mapMethods(Tag);","map":{"version":3,"sources":["/mnt/c/Users/anjul/OneDrive - Stony Brook University/Documents/infographics_generation/interface/node_modules/konva/lib/shapes/Label.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","exports","value","Util_1","require","Factory_1","Shape_1","Group_1","Validators_1","Global_1","ATTR_CHANGE_LIST","CHANGE_KONVA","NONE","UP","RIGHT","DOWN","LEFT","attrChangeListLen","length","Label","_super","config","_this","call","on","evt","_addListeners","child","_sync","getText","find","getTag","text","that","n","func","getWidth","width","getHeight","height","tag","pointerDirection","pointerWidth","x","y","pointerHeight","setAttrs","Group","className","_registerNode","Collection","mapMethods","Tag","apply","arguments","_sceneFunc","context","cornerRadius","Math","min","beginPath","moveTo","lineTo","arc","PI","closePath","fillStrokeShape","getSelfRect","direction","Shape","Factory","addGetterSetter","getNumberValidator"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Util_1 = require(\"../Util\");\nvar Factory_1 = require(\"../Factory\");\nvar Shape_1 = require(\"../Shape\");\nvar Group_1 = require(\"../Group\");\nvar Validators_1 = require(\"../Validators\");\nvar Global_1 = require(\"../Global\");\nvar ATTR_CHANGE_LIST = [\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'padding',\n    'lineHeight',\n    'text',\n    'width'\n], CHANGE_KONVA = 'Change.konva', NONE = 'none', UP = 'up', RIGHT = 'right', DOWN = 'down', LEFT = 'left', attrChangeListLen = ATTR_CHANGE_LIST.length;\nvar Label = (function (_super) {\n    __extends(Label, _super);\n    function Label(config) {\n        var _this = _super.call(this, config) || this;\n        _this.on('add.konva', function (evt) {\n            this._addListeners(evt.child);\n            this._sync();\n        });\n        return _this;\n    }\n    Label.prototype.getText = function () {\n        return this.find('Text')[0];\n    };\n    Label.prototype.getTag = function () {\n        return this.find('Tag')[0];\n    };\n    Label.prototype._addListeners = function (text) {\n        var that = this, n;\n        var func = function () {\n            that._sync();\n        };\n        for (n = 0; n < attrChangeListLen; n++) {\n            text.on(ATTR_CHANGE_LIST[n] + CHANGE_KONVA, func);\n        }\n    };\n    Label.prototype.getWidth = function () {\n        return this.getText().width();\n    };\n    Label.prototype.getHeight = function () {\n        return this.getText().height();\n    };\n    Label.prototype._sync = function () {\n        var text = this.getText(), tag = this.getTag(), width, height, pointerDirection, pointerWidth, x, y, pointerHeight;\n        if (text && tag) {\n            width = text.width();\n            height = text.height();\n            pointerDirection = tag.pointerDirection();\n            pointerWidth = tag.pointerWidth();\n            pointerHeight = tag.pointerHeight();\n            x = 0;\n            y = 0;\n            switch (pointerDirection) {\n                case UP:\n                    x = width / 2;\n                    y = -1 * pointerHeight;\n                    break;\n                case RIGHT:\n                    x = width + pointerWidth;\n                    y = height / 2;\n                    break;\n                case DOWN:\n                    x = width / 2;\n                    y = height + pointerHeight;\n                    break;\n                case LEFT:\n                    x = -1 * pointerWidth;\n                    y = height / 2;\n                    break;\n            }\n            tag.setAttrs({\n                x: -1 * x,\n                y: -1 * y,\n                width: width,\n                height: height\n            });\n            text.setAttrs({\n                x: -1 * x,\n                y: -1 * y\n            });\n        }\n    };\n    return Label;\n}(Group_1.Group));\nexports.Label = Label;\nLabel.prototype.className = 'Label';\nGlobal_1._registerNode(Label);\nUtil_1.Collection.mapMethods(Label);\nvar Tag = (function (_super) {\n    __extends(Tag, _super);\n    function Tag() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Tag.prototype._sceneFunc = function (context) {\n        var width = this.width(), height = this.height(), pointerDirection = this.pointerDirection(), pointerWidth = this.pointerWidth(), pointerHeight = this.pointerHeight(), cornerRadius = Math.min(this.cornerRadius(), width / 2, height / 2);\n        context.beginPath();\n        if (!cornerRadius) {\n            context.moveTo(0, 0);\n        }\n        else {\n            context.moveTo(cornerRadius, 0);\n        }\n        if (pointerDirection === UP) {\n            context.lineTo((width - pointerWidth) / 2, 0);\n            context.lineTo(width / 2, -1 * pointerHeight);\n            context.lineTo((width + pointerWidth) / 2, 0);\n        }\n        if (!cornerRadius) {\n            context.lineTo(width, 0);\n        }\n        else {\n            context.lineTo(width - cornerRadius, 0);\n            context.arc(width - cornerRadius, cornerRadius, cornerRadius, (Math.PI * 3) / 2, 0, false);\n        }\n        if (pointerDirection === RIGHT) {\n            context.lineTo(width, (height - pointerHeight) / 2);\n            context.lineTo(width + pointerWidth, height / 2);\n            context.lineTo(width, (height + pointerHeight) / 2);\n        }\n        if (!cornerRadius) {\n            context.lineTo(width, height);\n        }\n        else {\n            context.lineTo(width, height - cornerRadius);\n            context.arc(width - cornerRadius, height - cornerRadius, cornerRadius, 0, Math.PI / 2, false);\n        }\n        if (pointerDirection === DOWN) {\n            context.lineTo((width + pointerWidth) / 2, height);\n            context.lineTo(width / 2, height + pointerHeight);\n            context.lineTo((width - pointerWidth) / 2, height);\n        }\n        if (!cornerRadius) {\n            context.lineTo(0, height);\n        }\n        else {\n            context.lineTo(cornerRadius, height);\n            context.arc(cornerRadius, height - cornerRadius, cornerRadius, Math.PI / 2, Math.PI, false);\n        }\n        if (pointerDirection === LEFT) {\n            context.lineTo(0, (height + pointerHeight) / 2);\n            context.lineTo(-1 * pointerWidth, height / 2);\n            context.lineTo(0, (height - pointerHeight) / 2);\n        }\n        if (cornerRadius) {\n            context.lineTo(0, cornerRadius);\n            context.arc(cornerRadius, cornerRadius, cornerRadius, Math.PI, (Math.PI * 3) / 2, false);\n        }\n        context.closePath();\n        context.fillStrokeShape(this);\n    };\n    Tag.prototype.getSelfRect = function () {\n        var x = 0, y = 0, pointerWidth = this.pointerWidth(), pointerHeight = this.pointerHeight(), direction = this.pointerDirection(), width = this.width(), height = this.height();\n        if (direction === UP) {\n            y -= pointerHeight;\n            height += pointerHeight;\n        }\n        else if (direction === DOWN) {\n            height += pointerHeight;\n        }\n        else if (direction === LEFT) {\n            x -= pointerWidth * 1.5;\n            width += pointerWidth;\n        }\n        else if (direction === RIGHT) {\n            width += pointerWidth * 1.5;\n        }\n        return {\n            x: x,\n            y: y,\n            width: width,\n            height: height\n        };\n    };\n    return Tag;\n}(Shape_1.Shape));\nexports.Tag = Tag;\nTag.prototype.className = 'Tag';\nGlobal_1._registerNode(Tag);\nFactory_1.Factory.addGetterSetter(Tag, 'pointerDirection', NONE);\nFactory_1.Factory.addGetterSetter(Tag, 'pointerWidth', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Tag, 'pointerHeight', 0, Validators_1.getNumberValidator());\nFactory_1.Factory.addGetterSetter(Tag, 'cornerRadius', 0, Validators_1.getNumberValidator());\nUtil_1.Collection.mapMethods(Tag);\n"]},"metadata":{},"sourceType":"script"}