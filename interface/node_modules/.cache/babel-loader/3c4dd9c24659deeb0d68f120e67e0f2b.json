{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Util_1 = require(\"./Util\");\n\nvar Animation_1 = require(\"./Animation\");\n\nvar Node_1 = require(\"./Node\");\n\nvar Global_1 = require(\"./Global\");\n\nvar blacklist = {\n  node: 1,\n  duration: 1,\n  easing: 1,\n  onFinish: 1,\n  yoyo: 1\n},\n    PAUSED = 1,\n    PLAYING = 2,\n    REVERSING = 3,\n    idCounter = 0,\n    colorAttrs = ['fill', 'stroke', 'shadowColor'];\n\nvar TweenEngine = function () {\n  function TweenEngine(prop, propFunc, func, begin, finish, duration, yoyo) {\n    this.prop = prop;\n    this.propFunc = propFunc;\n    this.begin = begin;\n    this._pos = begin;\n    this.duration = duration;\n    this._change = 0;\n    this.prevPos = 0;\n    this.yoyo = yoyo;\n    this._time = 0;\n    this._position = 0;\n    this._startTime = 0;\n    this._finish = 0;\n    this.func = func;\n    this._change = finish - this.begin;\n    this.pause();\n  }\n\n  TweenEngine.prototype.fire = function (str) {\n    var handler = this[str];\n\n    if (handler) {\n      handler();\n    }\n  };\n\n  TweenEngine.prototype.setTime = function (t) {\n    if (t > this.duration) {\n      if (this.yoyo) {\n        this._time = this.duration;\n        this.reverse();\n      } else {\n        this.finish();\n      }\n    } else if (t < 0) {\n      if (this.yoyo) {\n        this._time = 0;\n        this.play();\n      } else {\n        this.reset();\n      }\n    } else {\n      this._time = t;\n      this.update();\n    }\n  };\n\n  TweenEngine.prototype.getTime = function () {\n    return this._time;\n  };\n\n  TweenEngine.prototype.setPosition = function (p) {\n    this.prevPos = this._pos;\n    this.propFunc(p);\n    this._pos = p;\n  };\n\n  TweenEngine.prototype.getPosition = function (t) {\n    if (t === undefined) {\n      t = this._time;\n    }\n\n    return this.func(t, this.begin, this._change, this.duration);\n  };\n\n  TweenEngine.prototype.play = function () {\n    this.state = PLAYING;\n    this._startTime = this.getTimer() - this._time;\n    this.onEnterFrame();\n    this.fire('onPlay');\n  };\n\n  TweenEngine.prototype.reverse = function () {\n    this.state = REVERSING;\n    this._time = this.duration - this._time;\n    this._startTime = this.getTimer() - this._time;\n    this.onEnterFrame();\n    this.fire('onReverse');\n  };\n\n  TweenEngine.prototype.seek = function (t) {\n    this.pause();\n    this._time = t;\n    this.update();\n    this.fire('onSeek');\n  };\n\n  TweenEngine.prototype.reset = function () {\n    this.pause();\n    this._time = 0;\n    this.update();\n    this.fire('onReset');\n  };\n\n  TweenEngine.prototype.finish = function () {\n    this.pause();\n    this._time = this.duration;\n    this.update();\n    this.fire('onFinish');\n  };\n\n  TweenEngine.prototype.update = function () {\n    this.setPosition(this.getPosition(this._time));\n  };\n\n  TweenEngine.prototype.onEnterFrame = function () {\n    var t = this.getTimer() - this._startTime;\n\n    if (this.state === PLAYING) {\n      this.setTime(t);\n    } else if (this.state === REVERSING) {\n      this.setTime(this.duration - t);\n    }\n  };\n\n  TweenEngine.prototype.pause = function () {\n    this.state = PAUSED;\n    this.fire('onPause');\n  };\n\n  TweenEngine.prototype.getTimer = function () {\n    return new Date().getTime();\n  };\n\n  return TweenEngine;\n}();\n\nvar Tween = function () {\n  function Tween(config) {\n    var that = this,\n        node = config.node,\n        nodeId = node._id,\n        duration,\n        easing = config.easing || exports.Easings.Linear,\n        yoyo = !!config.yoyo,\n        key;\n\n    if (typeof config.duration === 'undefined') {\n      duration = 0.3;\n    } else if (config.duration === 0) {\n      duration = 0.001;\n    } else {\n      duration = config.duration;\n    }\n\n    this.node = node;\n    this._id = idCounter++;\n    var layers = node.getLayer() || (node instanceof Global_1.Konva['Stage'] ? node.getLayers() : null);\n\n    if (!layers) {\n      Util_1.Util.error('Tween constructor have `node` that is not in a layer. Please add node into layer first.');\n    }\n\n    this.anim = new Animation_1.Animation(function () {\n      that.tween.onEnterFrame();\n    }, layers);\n    this.tween = new TweenEngine(key, function (i) {\n      that._tweenFunc(i);\n    }, easing, 0, 1, duration * 1000, yoyo);\n\n    this._addListeners();\n\n    if (!Tween.attrs[nodeId]) {\n      Tween.attrs[nodeId] = {};\n    }\n\n    if (!Tween.attrs[nodeId][this._id]) {\n      Tween.attrs[nodeId][this._id] = {};\n    }\n\n    if (!Tween.tweens[nodeId]) {\n      Tween.tweens[nodeId] = {};\n    }\n\n    for (key in config) {\n      if (blacklist[key] === undefined) {\n        this._addAttr(key, config[key]);\n      }\n    }\n\n    this.reset();\n    this.onFinish = config.onFinish;\n    this.onReset = config.onReset;\n  }\n\n  Tween.prototype._addAttr = function (key, end) {\n    var node = this.node,\n        nodeId = node._id,\n        start,\n        diff,\n        tweenId,\n        n,\n        len,\n        trueEnd,\n        trueStart,\n        endRGBA;\n    tweenId = Tween.tweens[nodeId][key];\n\n    if (tweenId) {\n      delete Tween.attrs[nodeId][tweenId][key];\n    }\n\n    start = node.getAttr(key);\n\n    if (Util_1.Util._isArray(end)) {\n      diff = [];\n      len = Math.max(end.length, start.length);\n\n      if (key === 'points' && end.length !== start.length) {\n        if (end.length > start.length) {\n          trueStart = start;\n          start = Util_1.Util._prepareArrayForTween(start, end, node.closed());\n        } else {\n          trueEnd = end;\n          end = Util_1.Util._prepareArrayForTween(end, start, node.closed());\n        }\n      }\n\n      if (key.indexOf('fill') === 0) {\n        for (n = 0; n < len; n++) {\n          if (n % 2 === 0) {\n            diff.push(end[n] - start[n]);\n          } else {\n            var startRGBA = Util_1.Util.colorToRGBA(start[n]);\n            endRGBA = Util_1.Util.colorToRGBA(end[n]);\n            start[n] = startRGBA;\n            diff.push({\n              r: endRGBA.r - startRGBA.r,\n              g: endRGBA.g - startRGBA.g,\n              b: endRGBA.b - startRGBA.b,\n              a: endRGBA.a - startRGBA.a\n            });\n          }\n        }\n      } else {\n        for (n = 0; n < len; n++) {\n          diff.push(end[n] - start[n]);\n        }\n      }\n    } else if (colorAttrs.indexOf(key) !== -1) {\n      start = Util_1.Util.colorToRGBA(start);\n      endRGBA = Util_1.Util.colorToRGBA(end);\n      diff = {\n        r: endRGBA.r - start.r,\n        g: endRGBA.g - start.g,\n        b: endRGBA.b - start.b,\n        a: endRGBA.a - start.a\n      };\n    } else {\n      diff = end - start;\n    }\n\n    Tween.attrs[nodeId][this._id][key] = {\n      start: start,\n      diff: diff,\n      end: end,\n      trueEnd: trueEnd,\n      trueStart: trueStart\n    };\n    Tween.tweens[nodeId][key] = this._id;\n  };\n\n  Tween.prototype._tweenFunc = function (i) {\n    var node = this.node,\n        attrs = Tween.attrs[node._id][this._id],\n        key,\n        attr,\n        start,\n        diff,\n        newVal,\n        n,\n        len,\n        end;\n\n    for (key in attrs) {\n      attr = attrs[key];\n      start = attr.start;\n      diff = attr.diff;\n      end = attr.end;\n\n      if (Util_1.Util._isArray(start)) {\n        newVal = [];\n        len = Math.max(start.length, end.length);\n\n        if (key.indexOf('fill') === 0) {\n          for (n = 0; n < len; n++) {\n            if (n % 2 === 0) {\n              newVal.push((start[n] || 0) + diff[n] * i);\n            } else {\n              newVal.push('rgba(' + Math.round(start[n].r + diff[n].r * i) + ',' + Math.round(start[n].g + diff[n].g * i) + ',' + Math.round(start[n].b + diff[n].b * i) + ',' + (start[n].a + diff[n].a * i) + ')');\n            }\n          }\n        } else {\n          for (n = 0; n < len; n++) {\n            newVal.push((start[n] || 0) + diff[n] * i);\n          }\n        }\n      } else if (colorAttrs.indexOf(key) !== -1) {\n        newVal = 'rgba(' + Math.round(start.r + diff.r * i) + ',' + Math.round(start.g + diff.g * i) + ',' + Math.round(start.b + diff.b * i) + ',' + (start.a + diff.a * i) + ')';\n      } else {\n        newVal = start + diff * i;\n      }\n\n      node.setAttr(key, newVal);\n    }\n  };\n\n  Tween.prototype._addListeners = function () {\n    var _this = this;\n\n    this.tween.onPlay = function () {\n      _this.anim.start();\n    };\n\n    this.tween.onReverse = function () {\n      _this.anim.start();\n    };\n\n    this.tween.onPause = function () {\n      _this.anim.stop();\n    };\n\n    this.tween.onFinish = function () {\n      var node = _this.node;\n      var attrs = Tween.attrs[node._id][_this._id];\n\n      if (attrs.points && attrs.points.trueEnd) {\n        node.setAttr('points', attrs.points.trueEnd);\n      }\n\n      if (_this.onFinish) {\n        _this.onFinish.call(_this);\n      }\n    };\n\n    this.tween.onReset = function () {\n      var node = _this.node;\n      var attrs = Tween.attrs[node._id][_this._id];\n\n      if (attrs.points && attrs.points.trueStart) {\n        node.points(attrs.points.trueStart);\n      }\n\n      if (_this.onReset) {\n        _this.onReset();\n      }\n    };\n  };\n\n  Tween.prototype.play = function () {\n    this.tween.play();\n    return this;\n  };\n\n  Tween.prototype.reverse = function () {\n    this.tween.reverse();\n    return this;\n  };\n\n  Tween.prototype.reset = function () {\n    this.tween.reset();\n    return this;\n  };\n\n  Tween.prototype.seek = function (t) {\n    this.tween.seek(t * 1000);\n    return this;\n  };\n\n  Tween.prototype.pause = function () {\n    this.tween.pause();\n    return this;\n  };\n\n  Tween.prototype.finish = function () {\n    this.tween.finish();\n    return this;\n  };\n\n  Tween.prototype.destroy = function () {\n    var nodeId = this.node._id,\n        thisId = this._id,\n        attrs = Tween.tweens[nodeId],\n        key;\n    this.pause();\n\n    for (key in attrs) {\n      delete Tween.tweens[nodeId][key];\n    }\n\n    delete Tween.attrs[nodeId][thisId];\n  };\n\n  Tween.attrs = {};\n  Tween.tweens = {};\n  return Tween;\n}();\n\nexports.Tween = Tween;\n\nNode_1.Node.prototype.to = function (params) {\n  var onFinish = params.onFinish;\n  params.node = this;\n\n  params.onFinish = function () {\n    this.destroy();\n\n    if (onFinish) {\n      onFinish();\n    }\n  };\n\n  var tween = new Tween(params);\n  tween.play();\n};\n\nexports.Easings = {\n  BackEaseIn: function (t, b, c, d) {\n    var s = 1.70158;\n    return c * (t /= d) * t * ((s + 1) * t - s) + b;\n  },\n  BackEaseOut: function (t, b, c, d) {\n    var s = 1.70158;\n    return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n  },\n  BackEaseInOut: function (t, b, c, d) {\n    var s = 1.70158;\n\n    if ((t /= d / 2) < 1) {\n      return c / 2 * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n    }\n\n    return c / 2 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n  },\n  ElasticEaseIn: function (t, b, c, d, a, p) {\n    var s = 0;\n\n    if (t === 0) {\n      return b;\n    }\n\n    if ((t /= d) === 1) {\n      return b + c;\n    }\n\n    if (!p) {\n      p = d * 0.3;\n    }\n\n    if (!a || a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n  },\n  ElasticEaseOut: function (t, b, c, d, a, p) {\n    var s = 0;\n\n    if (t === 0) {\n      return b;\n    }\n\n    if ((t /= d) === 1) {\n      return b + c;\n    }\n\n    if (!p) {\n      p = d * 0.3;\n    }\n\n    if (!a || a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    return a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b;\n  },\n  ElasticEaseInOut: function (t, b, c, d, a, p) {\n    var s = 0;\n\n    if (t === 0) {\n      return b;\n    }\n\n    if ((t /= d / 2) === 2) {\n      return b + c;\n    }\n\n    if (!p) {\n      p = d * (0.3 * 1.5);\n    }\n\n    if (!a || a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = p / (2 * Math.PI) * Math.asin(c / a);\n    }\n\n    if (t < 1) {\n      return -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;\n    }\n\n    return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * 0.5 + c + b;\n  },\n  BounceEaseOut: function (t, b, c, d) {\n    if ((t /= d) < 1 / 2.75) {\n      return c * (7.5625 * t * t) + b;\n    } else if (t < 2 / 2.75) {\n      return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n    } else if (t < 2.5 / 2.75) {\n      return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n    } else {\n      return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n    }\n  },\n  BounceEaseIn: function (t, b, c, d) {\n    return c - exports.Easings.BounceEaseOut(d - t, 0, c, d) + b;\n  },\n  BounceEaseInOut: function (t, b, c, d) {\n    if (t < d / 2) {\n      return exports.Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;\n    } else {\n      return exports.Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n    }\n  },\n  EaseIn: function (t, b, c, d) {\n    return c * (t /= d) * t + b;\n  },\n  EaseOut: function (t, b, c, d) {\n    return -c * (t /= d) * (t - 2) + b;\n  },\n  EaseInOut: function (t, b, c, d) {\n    if ((t /= d / 2) < 1) {\n      return c / 2 * t * t + b;\n    }\n\n    return -c / 2 * (--t * (t - 2) - 1) + b;\n  },\n  StrongEaseIn: function (t, b, c, d) {\n    return c * (t /= d) * t * t * t * t + b;\n  },\n  StrongEaseOut: function (t, b, c, d) {\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n  },\n  StrongEaseInOut: function (t, b, c, d) {\n    if ((t /= d / 2) < 1) {\n      return c / 2 * t * t * t * t * t + b;\n    }\n\n    return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\n  },\n  Linear: function (t, b, c, d) {\n    return c * t / d + b;\n  }\n};","map":{"version":3,"sources":["/mnt/c/Users/anjul/OneDrive - Stony Brook University/Documents/infographics_generation/interface/node_modules/konva/lib/Tween.js"],"names":["Object","defineProperty","exports","value","Util_1","require","Animation_1","Node_1","Global_1","blacklist","node","duration","easing","onFinish","yoyo","PAUSED","PLAYING","REVERSING","idCounter","colorAttrs","TweenEngine","prop","propFunc","func","begin","finish","_pos","_change","prevPos","_time","_position","_startTime","_finish","pause","prototype","fire","str","handler","setTime","t","reverse","play","reset","update","getTime","setPosition","p","getPosition","undefined","state","getTimer","onEnterFrame","seek","Date","Tween","config","that","nodeId","_id","Easings","Linear","key","layers","getLayer","Konva","getLayers","Util","error","anim","Animation","tween","i","_tweenFunc","_addListeners","attrs","tweens","_addAttr","onReset","end","start","diff","tweenId","n","len","trueEnd","trueStart","endRGBA","getAttr","_isArray","Math","max","length","_prepareArrayForTween","closed","indexOf","push","startRGBA","colorToRGBA","r","g","b","a","attr","newVal","round","setAttr","_this","onPlay","onReverse","onPause","stop","points","call","destroy","thisId","Node","to","params","BackEaseIn","c","d","s","BackEaseOut","BackEaseInOut","ElasticEaseIn","abs","PI","asin","pow","sin","ElasticEaseOut","ElasticEaseInOut","BounceEaseOut","BounceEaseIn","BounceEaseInOut","EaseIn","EaseOut","EaseInOut","StrongEaseIn","StrongEaseOut","StrongEaseInOut"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Util_1 = require(\"./Util\");\nvar Animation_1 = require(\"./Animation\");\nvar Node_1 = require(\"./Node\");\nvar Global_1 = require(\"./Global\");\nvar blacklist = {\n    node: 1,\n    duration: 1,\n    easing: 1,\n    onFinish: 1,\n    yoyo: 1\n}, PAUSED = 1, PLAYING = 2, REVERSING = 3, idCounter = 0, colorAttrs = ['fill', 'stroke', 'shadowColor'];\nvar TweenEngine = (function () {\n    function TweenEngine(prop, propFunc, func, begin, finish, duration, yoyo) {\n        this.prop = prop;\n        this.propFunc = propFunc;\n        this.begin = begin;\n        this._pos = begin;\n        this.duration = duration;\n        this._change = 0;\n        this.prevPos = 0;\n        this.yoyo = yoyo;\n        this._time = 0;\n        this._position = 0;\n        this._startTime = 0;\n        this._finish = 0;\n        this.func = func;\n        this._change = finish - this.begin;\n        this.pause();\n    }\n    TweenEngine.prototype.fire = function (str) {\n        var handler = this[str];\n        if (handler) {\n            handler();\n        }\n    };\n    TweenEngine.prototype.setTime = function (t) {\n        if (t > this.duration) {\n            if (this.yoyo) {\n                this._time = this.duration;\n                this.reverse();\n            }\n            else {\n                this.finish();\n            }\n        }\n        else if (t < 0) {\n            if (this.yoyo) {\n                this._time = 0;\n                this.play();\n            }\n            else {\n                this.reset();\n            }\n        }\n        else {\n            this._time = t;\n            this.update();\n        }\n    };\n    TweenEngine.prototype.getTime = function () {\n        return this._time;\n    };\n    TweenEngine.prototype.setPosition = function (p) {\n        this.prevPos = this._pos;\n        this.propFunc(p);\n        this._pos = p;\n    };\n    TweenEngine.prototype.getPosition = function (t) {\n        if (t === undefined) {\n            t = this._time;\n        }\n        return this.func(t, this.begin, this._change, this.duration);\n    };\n    TweenEngine.prototype.play = function () {\n        this.state = PLAYING;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onPlay');\n    };\n    TweenEngine.prototype.reverse = function () {\n        this.state = REVERSING;\n        this._time = this.duration - this._time;\n        this._startTime = this.getTimer() - this._time;\n        this.onEnterFrame();\n        this.fire('onReverse');\n    };\n    TweenEngine.prototype.seek = function (t) {\n        this.pause();\n        this._time = t;\n        this.update();\n        this.fire('onSeek');\n    };\n    TweenEngine.prototype.reset = function () {\n        this.pause();\n        this._time = 0;\n        this.update();\n        this.fire('onReset');\n    };\n    TweenEngine.prototype.finish = function () {\n        this.pause();\n        this._time = this.duration;\n        this.update();\n        this.fire('onFinish');\n    };\n    TweenEngine.prototype.update = function () {\n        this.setPosition(this.getPosition(this._time));\n    };\n    TweenEngine.prototype.onEnterFrame = function () {\n        var t = this.getTimer() - this._startTime;\n        if (this.state === PLAYING) {\n            this.setTime(t);\n        }\n        else if (this.state === REVERSING) {\n            this.setTime(this.duration - t);\n        }\n    };\n    TweenEngine.prototype.pause = function () {\n        this.state = PAUSED;\n        this.fire('onPause');\n    };\n    TweenEngine.prototype.getTimer = function () {\n        return new Date().getTime();\n    };\n    return TweenEngine;\n}());\nvar Tween = (function () {\n    function Tween(config) {\n        var that = this, node = config.node, nodeId = node._id, duration, easing = config.easing || exports.Easings.Linear, yoyo = !!config.yoyo, key;\n        if (typeof config.duration === 'undefined') {\n            duration = 0.3;\n        }\n        else if (config.duration === 0) {\n            duration = 0.001;\n        }\n        else {\n            duration = config.duration;\n        }\n        this.node = node;\n        this._id = idCounter++;\n        var layers = node.getLayer() ||\n            (node instanceof Global_1.Konva['Stage'] ? node.getLayers() : null);\n        if (!layers) {\n            Util_1.Util.error('Tween constructor have `node` that is not in a layer. Please add node into layer first.');\n        }\n        this.anim = new Animation_1.Animation(function () {\n            that.tween.onEnterFrame();\n        }, layers);\n        this.tween = new TweenEngine(key, function (i) {\n            that._tweenFunc(i);\n        }, easing, 0, 1, duration * 1000, yoyo);\n        this._addListeners();\n        if (!Tween.attrs[nodeId]) {\n            Tween.attrs[nodeId] = {};\n        }\n        if (!Tween.attrs[nodeId][this._id]) {\n            Tween.attrs[nodeId][this._id] = {};\n        }\n        if (!Tween.tweens[nodeId]) {\n            Tween.tweens[nodeId] = {};\n        }\n        for (key in config) {\n            if (blacklist[key] === undefined) {\n                this._addAttr(key, config[key]);\n            }\n        }\n        this.reset();\n        this.onFinish = config.onFinish;\n        this.onReset = config.onReset;\n    }\n    Tween.prototype._addAttr = function (key, end) {\n        var node = this.node, nodeId = node._id, start, diff, tweenId, n, len, trueEnd, trueStart, endRGBA;\n        tweenId = Tween.tweens[nodeId][key];\n        if (tweenId) {\n            delete Tween.attrs[nodeId][tweenId][key];\n        }\n        start = node.getAttr(key);\n        if (Util_1.Util._isArray(end)) {\n            diff = [];\n            len = Math.max(end.length, start.length);\n            if (key === 'points' && end.length !== start.length) {\n                if (end.length > start.length) {\n                    trueStart = start;\n                    start = Util_1.Util._prepareArrayForTween(start, end, node.closed());\n                }\n                else {\n                    trueEnd = end;\n                    end = Util_1.Util._prepareArrayForTween(end, start, node.closed());\n                }\n            }\n            if (key.indexOf('fill') === 0) {\n                for (n = 0; n < len; n++) {\n                    if (n % 2 === 0) {\n                        diff.push(end[n] - start[n]);\n                    }\n                    else {\n                        var startRGBA = Util_1.Util.colorToRGBA(start[n]);\n                        endRGBA = Util_1.Util.colorToRGBA(end[n]);\n                        start[n] = startRGBA;\n                        diff.push({\n                            r: endRGBA.r - startRGBA.r,\n                            g: endRGBA.g - startRGBA.g,\n                            b: endRGBA.b - startRGBA.b,\n                            a: endRGBA.a - startRGBA.a\n                        });\n                    }\n                }\n            }\n            else {\n                for (n = 0; n < len; n++) {\n                    diff.push(end[n] - start[n]);\n                }\n            }\n        }\n        else if (colorAttrs.indexOf(key) !== -1) {\n            start = Util_1.Util.colorToRGBA(start);\n            endRGBA = Util_1.Util.colorToRGBA(end);\n            diff = {\n                r: endRGBA.r - start.r,\n                g: endRGBA.g - start.g,\n                b: endRGBA.b - start.b,\n                a: endRGBA.a - start.a\n            };\n        }\n        else {\n            diff = end - start;\n        }\n        Tween.attrs[nodeId][this._id][key] = {\n            start: start,\n            diff: diff,\n            end: end,\n            trueEnd: trueEnd,\n            trueStart: trueStart\n        };\n        Tween.tweens[nodeId][key] = this._id;\n    };\n    Tween.prototype._tweenFunc = function (i) {\n        var node = this.node, attrs = Tween.attrs[node._id][this._id], key, attr, start, diff, newVal, n, len, end;\n        for (key in attrs) {\n            attr = attrs[key];\n            start = attr.start;\n            diff = attr.diff;\n            end = attr.end;\n            if (Util_1.Util._isArray(start)) {\n                newVal = [];\n                len = Math.max(start.length, end.length);\n                if (key.indexOf('fill') === 0) {\n                    for (n = 0; n < len; n++) {\n                        if (n % 2 === 0) {\n                            newVal.push((start[n] || 0) + diff[n] * i);\n                        }\n                        else {\n                            newVal.push('rgba(' +\n                                Math.round(start[n].r + diff[n].r * i) +\n                                ',' +\n                                Math.round(start[n].g + diff[n].g * i) +\n                                ',' +\n                                Math.round(start[n].b + diff[n].b * i) +\n                                ',' +\n                                (start[n].a + diff[n].a * i) +\n                                ')');\n                        }\n                    }\n                }\n                else {\n                    for (n = 0; n < len; n++) {\n                        newVal.push((start[n] || 0) + diff[n] * i);\n                    }\n                }\n            }\n            else if (colorAttrs.indexOf(key) !== -1) {\n                newVal =\n                    'rgba(' +\n                        Math.round(start.r + diff.r * i) +\n                        ',' +\n                        Math.round(start.g + diff.g * i) +\n                        ',' +\n                        Math.round(start.b + diff.b * i) +\n                        ',' +\n                        (start.a + diff.a * i) +\n                        ')';\n            }\n            else {\n                newVal = start + diff * i;\n            }\n            node.setAttr(key, newVal);\n        }\n    };\n    Tween.prototype._addListeners = function () {\n        var _this = this;\n        this.tween.onPlay = function () {\n            _this.anim.start();\n        };\n        this.tween.onReverse = function () {\n            _this.anim.start();\n        };\n        this.tween.onPause = function () {\n            _this.anim.stop();\n        };\n        this.tween.onFinish = function () {\n            var node = _this.node;\n            var attrs = Tween.attrs[node._id][_this._id];\n            if (attrs.points && attrs.points.trueEnd) {\n                node.setAttr('points', attrs.points.trueEnd);\n            }\n            if (_this.onFinish) {\n                _this.onFinish.call(_this);\n            }\n        };\n        this.tween.onReset = function () {\n            var node = _this.node;\n            var attrs = Tween.attrs[node._id][_this._id];\n            if (attrs.points && attrs.points.trueStart) {\n                node.points(attrs.points.trueStart);\n            }\n            if (_this.onReset) {\n                _this.onReset();\n            }\n        };\n    };\n    Tween.prototype.play = function () {\n        this.tween.play();\n        return this;\n    };\n    Tween.prototype.reverse = function () {\n        this.tween.reverse();\n        return this;\n    };\n    Tween.prototype.reset = function () {\n        this.tween.reset();\n        return this;\n    };\n    Tween.prototype.seek = function (t) {\n        this.tween.seek(t * 1000);\n        return this;\n    };\n    Tween.prototype.pause = function () {\n        this.tween.pause();\n        return this;\n    };\n    Tween.prototype.finish = function () {\n        this.tween.finish();\n        return this;\n    };\n    Tween.prototype.destroy = function () {\n        var nodeId = this.node._id, thisId = this._id, attrs = Tween.tweens[nodeId], key;\n        this.pause();\n        for (key in attrs) {\n            delete Tween.tweens[nodeId][key];\n        }\n        delete Tween.attrs[nodeId][thisId];\n    };\n    Tween.attrs = {};\n    Tween.tweens = {};\n    return Tween;\n}());\nexports.Tween = Tween;\nNode_1.Node.prototype.to = function (params) {\n    var onFinish = params.onFinish;\n    params.node = this;\n    params.onFinish = function () {\n        this.destroy();\n        if (onFinish) {\n            onFinish();\n        }\n    };\n    var tween = new Tween(params);\n    tween.play();\n};\nexports.Easings = {\n    BackEaseIn: function (t, b, c, d) {\n        var s = 1.70158;\n        return c * (t /= d) * t * ((s + 1) * t - s) + b;\n    },\n    BackEaseOut: function (t, b, c, d) {\n        var s = 1.70158;\n        return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n    },\n    BackEaseInOut: function (t, b, c, d) {\n        var s = 1.70158;\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n        }\n        return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n    },\n    ElasticEaseIn: function (t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (-(a *\n            Math.pow(2, 10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b);\n    },\n    ElasticEaseOut: function (t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d) === 1) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * 0.3;\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        return (a * Math.pow(2, -10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) +\n            c +\n            b);\n    },\n    ElasticEaseInOut: function (t, b, c, d, a, p) {\n        var s = 0;\n        if (t === 0) {\n            return b;\n        }\n        if ((t /= d / 2) === 2) {\n            return b + c;\n        }\n        if (!p) {\n            p = d * (0.3 * 1.5);\n        }\n        if (!a || a < Math.abs(c)) {\n            a = c;\n            s = p / 4;\n        }\n        else {\n            s = (p / (2 * Math.PI)) * Math.asin(c / a);\n        }\n        if (t < 1) {\n            return (-0.5 *\n                (a *\n                    Math.pow(2, 10 * (t -= 1)) *\n                    Math.sin(((t * d - s) * (2 * Math.PI)) / p)) +\n                b);\n        }\n        return (a *\n            Math.pow(2, -10 * (t -= 1)) *\n            Math.sin(((t * d - s) * (2 * Math.PI)) / p) *\n            0.5 +\n            c +\n            b);\n    },\n    BounceEaseOut: function (t, b, c, d) {\n        if ((t /= d) < 1 / 2.75) {\n            return c * (7.5625 * t * t) + b;\n        }\n        else if (t < 2 / 2.75) {\n            return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n        }\n        else if (t < 2.5 / 2.75) {\n            return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n        }\n        else {\n            return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n        }\n    },\n    BounceEaseIn: function (t, b, c, d) {\n        return c - exports.Easings.BounceEaseOut(d - t, 0, c, d) + b;\n    },\n    BounceEaseInOut: function (t, b, c, d) {\n        if (t < d / 2) {\n            return exports.Easings.BounceEaseIn(t * 2, 0, c, d) * 0.5 + b;\n        }\n        else {\n            return exports.Easings.BounceEaseOut(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n        }\n    },\n    EaseIn: function (t, b, c, d) {\n        return c * (t /= d) * t + b;\n    },\n    EaseOut: function (t, b, c, d) {\n        return -c * (t /= d) * (t - 2) + b;\n    },\n    EaseInOut: function (t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t + b;\n        }\n        return (-c / 2) * (--t * (t - 2) - 1) + b;\n    },\n    StrongEaseIn: function (t, b, c, d) {\n        return c * (t /= d) * t * t * t * t + b;\n    },\n    StrongEaseOut: function (t, b, c, d) {\n        return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n    },\n    StrongEaseInOut: function (t, b, c, d) {\n        if ((t /= d / 2) < 1) {\n            return (c / 2) * t * t * t * t * t + b;\n        }\n        return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;\n    },\n    Linear: function (t, b, c, d) {\n        return (c * t) / d + b;\n    }\n};\n"]},"metadata":{},"sourceType":"script"}